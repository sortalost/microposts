{% extends 'base.html' %}
{% block title %}Home{% endblock %}
{% block body %}
{% if uploads==[] %}
<div class="term">
    <h2>Nothing here yet...</h2>
</div>
{% endif %}

<div class="delete-status">
    <h1>Deleting...</h1>
</div>

{% for item in uploads %}
<div class="term" id="{{ item.display_datetime[1] }}">
    <div class="meta">
        <span class="user">{{ user }}</span> |
        {{ item.display_datetime[0] }} |
        <span class="ago" data-timestamp="{{ item.display_datetime[1] }}"></span> |
        <a class="url" href="#{{ item.display_datetime[1] }}">#{{ item.display_datetime[1] }}</a>
    </div>
    <span>
        file:
        <a class="url" href="{{url_for('proxy_image', image_path=item.path) }}" target="_blank">
            {{ item.name }}
        </a>
        {% if session.get('logged_in') %}
        &nbsp;
        <a href="#" class="delete-link" data-filename="{{ item.name }}">[delete]</a>
        &nbsp;
        <a href="#" class="edit-link" data-filename="{{ item.name }}">[edit]</a>
        {% endif %}
    </span>
    <div class="media">
        <a href="{{ url_for('proxy_image', image_path=item.path) }}">
            <img src="{{ url_for('proxy_image', image_path=item.path) }}" alt="{{ item.name }}">
        </a>
    </div>
    {% if item.description %}
    <pre style="white-space: pre-line;">{{ item.description|safe }}</pre>
    <!-- <p style="white-space: pre-line;">{{ item.description|safe }}</p> -->
    {% endif %}
</div>
{% endfor %}
<div id="editModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; 
    background:rgba(0,0,0,0.5); justify-content:center; align-items:center; z-index:9999;">
    <div style="background:#fff; padding:20px; border-radius:5px; width:300px; position:relative;">
        <h3>Edit Description</h3>
        <form id="editForm">
            <textarea name="description" id="editTextarea" rows="5" style="width:100%;"></textarea>
            <input type="hidden" name="filename" id="editFilename">
            <div style="margin-top:10px; text-align:right;">
                <button type="button" id="editCancel">Cancel</button>
                <button type="submit">Save</button>
            </div>
        </form>
    </div>
</div>

{% endblock %}
